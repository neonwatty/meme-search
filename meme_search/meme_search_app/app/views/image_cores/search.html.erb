<!-- Override container constraint for search page -->
<div class="w-full max-w-full -mx-5">
  <div class="w-full px-5">
    <!-- Search Header -->
    <div class="text-center mb-8 mx-auto max-w-6xl px-4">
      <h1 class="text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent dark:from-indigo-400 dark:to-purple-400 mb-2">
        Search Memes
      </h1>
      <p class="text-gray-600 dark:text-gray-400">Find the perfect meme with keyword or vector search</p>
    </div>

    <!-- Search Form Card - Fixed Width Container -->
    <div class="mx-auto max-w-4xl px-4 mb-8">
      <div class="w-full bg-white/90 dark:bg-slate-800/90 backdrop-blur-2xl border border-white/20 dark:border-white/10 rounded-3xl p-8 shadow-2xl">
        <%= form_with url: search_items_image_cores_path, local: true, method: :post, data: {controller: "debounce", debounce_target: "form"} do |form| %>
          <!-- Search Input Row -->
          <div class="flex flex-col md:flex-row gap-4 items-center">
            <%= form.hidden_field :checkbox_value, value: '0', id: 'checkbox_value' %>
            <%= form.hidden_field :source, value: 'form' %>

            <!-- Search Input -->
            <div class="flex-1 w-full">
              <%= form.search_field :query,
                data: {action: "input->debounce#search"},
                placeholder: 'search images',
                class: "w-full px-6 py-4 text-black dark:text-white bg-white/90 dark:bg-slate-700/90 backdrop-blur-lg border-2 border-indigo-600 dark:border-indigo-400 rounded-2xl shadow-lg focus:outline-none focus:ring-4 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all",
                id: "search-box" %>
            </div>

            <!-- Tag Filter -->
            <div class="w-full md:w-64">
              <%= render 'tag_toggle' %>
            </div>

            <!-- Keyword/Vector Toggle -->
            <div class="flex items-center gap-3">
              <label class="inline-flex items-center cursor-pointer">
                <input type="checkbox" value="" class="sr-only peer" id="search-toggle-checkbox" onchange="updateText()">
                <div class="relative w-14 h-7 bg-gray-300 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:start-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-purple-600"></div>
                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300" id="search-toggle-text">keyword</span>
              </label>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Search Results Container - Full Width, Separate from Search Form -->
    <div class="flex flex-col items-center justify-center mx-auto max-w-6xl px-4">
      <div id="search_results" class="w-full min-h-[500px]">
        <%= render "image_cores/no_search" %>
      </div>
    </div>
  </div>
</div>
<script>
  function updateText() {
      const checkbox = document.getElementById('search-toggle-checkbox');
      const text = document.getElementById('search-toggle-text');
      const hiddenField = document.getElementById('checkbox_value');
      hiddenField.value = checkbox.checked ? '1' : '0';
      text.textContent = checkbox.checked ? 'Vector' : 'Keyword';
  }
</script>