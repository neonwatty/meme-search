<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gallery with Real-time Status Updates - Mockup</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Glassmorphism */
    .glass-card {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    .dark .glass-card {
      background: rgba(30, 41, 59, 0.9);
    }

    /* Status badge pulse animation */
    @keyframes pulse-badge {
      0%, 100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.8;
        transform: scale(1.05);
      }
    }

    .pulse-badge {
      animation: pulse-badge 2s ease-in-out infinite;
    }

    /* Shimmer effect for loading */
    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }

    .shimmer {
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      background-size: 1000px 100%;
      animation: shimmer 2s infinite;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-950 min-h-screen p-8">

  <div class="max-w-7xl mx-auto space-y-8">

    <!-- Page Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-slate-800 dark:text-white mb-2">
        Gallery with Real-time Status Updates - Mockup
      </h1>
      <p class="text-slate-600 dark:text-slate-400">
        Image cards update in real-time via ActionCable as bulk operation processes
      </p>
    </div>

    <!-- Active Filter Chips -->
    <div class="flex flex-wrap gap-2 justify-center mb-6">
      <span class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold shadow-md bg-gradient-to-r from-purple-500/20 to-purple-600/20 border border-purple-300 dark:border-purple-700 text-purple-700 dark:text-purple-300">
        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
        funny
        <button class="hover:bg-purple-600/30 rounded-full p-1">√ó</button>
      </span>
      <span class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold shadow-md bg-gradient-to-r from-blue-500/20 to-blue-600/20 border border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-300">
        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
        programming
        <button class="hover:bg-blue-600/30 rounded-full p-1">√ó</button>
      </span>
      <span class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold shadow-md bg-gradient-to-r from-gray-500/20 to-gray-600/20 border border-gray-300 dark:border-gray-700 text-gray-700 dark:text-gray-300">
        Has embeddings: false
        <button class="hover:bg-gray-600/30 rounded-full p-1">√ó</button>
      </span>
    </div>

    <!-- Gallery Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">

      <!-- Image 1: Not Started -->
      <div class="glass-card rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105">
        <div class="p-4">
          <!-- Image Preview -->
          <div class="relative mb-4">
            <img src="https://via.placeholder.com/300x200/334155/cbd5e1?text=cat_meme_01.jpg" alt="Meme" class="w-full h-48 object-cover rounded-xl">
            <!-- Tags -->
            <div class="absolute top-2 left-2 flex gap-1">
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-purple-500/80 text-white backdrop-blur-sm">funny</span>
            </div>
          </div>

          <!-- Image Info -->
          <h3 class="font-semibold text-slate-800 dark:text-white mb-2 truncate">cat_meme_01.jpg</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-3">/memes/cats</p>

          <!-- Status: Not Started -->
          <div id="status-image-core-id-1" class="mb-3">
            <button class="w-full bg-blue-500 hover:bg-cyan-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold transition">
              generate description ü™Ñ
            </button>
          </div>

          <!-- Description -->
          <div id="description-image-core-id-1" class="text-sm text-slate-600 dark:text-slate-400 italic">
            No description yet
          </div>
        </div>
      </div>

      <!-- Image 2: In Queue -->
      <div class="glass-card rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105">
        <div class="p-4">
          <div class="relative mb-4">
            <img src="https://via.placeholder.com/300x200/334155/cbd5e1?text=funny_dog.png" alt="Meme" class="w-full h-48 object-cover rounded-xl">
            <div class="absolute top-2 left-2 flex gap-1">
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-purple-500/80 text-white backdrop-blur-sm">funny</span>
            </div>
          </div>

          <h3 class="font-semibold text-slate-800 dark:text-white mb-2 truncate">funny_dog.png</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-3">/memes/dogs</p>

          <!-- Status: In Queue -->
          <div id="status-image-core-id-2" class="mb-3 flex gap-2">
            <span class="flex-1 bg-amber-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold text-center">
              in_queue ‚è≥
            </span>
            <button class="bg-red-500 hover:bg-red-400 text-white py-2 px-3 rounded-2xl text-sm font-semibold transition">
              cancel
            </button>
          </div>

          <div id="description-image-core-id-2" class="text-sm text-slate-600 dark:text-slate-400 italic">
            No description yet
          </div>
        </div>
      </div>

      <!-- Image 3: Processing (with shimmer effect) -->
      <div class="glass-card rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105 relative overflow-hidden">
        <!-- Shimmer overlay -->
        <div class="absolute inset-0 shimmer pointer-events-none z-10"></div>

        <div class="p-4">
          <div class="relative mb-4">
            <img src="https://via.placeholder.com/300x200/334155/cbd5e1?text=code_bug.jpg" alt="Meme" class="w-full h-48 object-cover rounded-xl">
            <div class="absolute top-2 left-2 flex gap-1">
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-blue-500/80 text-white backdrop-blur-sm">programming</span>
            </div>
          </div>

          <h3 class="font-semibold text-slate-800 dark:text-white mb-2 truncate">code_bug.jpg</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-3">/memes/work</p>

          <!-- Status: Processing -->
          <div id="status-image-core-id-3" class="mb-3">
            <span class="w-full block bg-emerald-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold text-center pulse-badge">
              processing üîÑ
            </span>
          </div>

          <div id="description-image-core-id-3" class="text-sm text-slate-600 dark:text-slate-400 italic">
            Generating description...
          </div>
        </div>
      </div>

      <!-- Image 4: Done (just completed, with green glow) -->
      <div class="glass-card rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105 ring-2 ring-emerald-400 dark:ring-emerald-600">
        <div class="p-4">
          <div class="relative mb-4">
            <img src="https://via.placeholder.com/300x200/334155/cbd5e1?text=meeting.jpg" alt="Meme" class="w-full h-48 object-cover rounded-xl">
            <div class="absolute top-2 left-2 flex gap-1">
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-purple-500/80 text-white backdrop-blur-sm">funny</span>
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-blue-500/80 text-white backdrop-blur-sm">programming</span>
            </div>
            <!-- Success indicator -->
            <div class="absolute top-2 right-2">
              <span class="flex h-3 w-3">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span>
              </span>
            </div>
          </div>

          <h3 class="font-semibold text-slate-800 dark:text-white mb-2 truncate">meeting.jpg</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-3">/memes/work</p>

          <!-- Status: Done -->
          <div id="status-image-core-id-4" class="mb-3">
            <button class="w-full bg-blue-500 hover:bg-cyan-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold transition flex items-center justify-center gap-2">
              <span>generate description ü™Ñ</span>
              <span class="text-xs bg-emerald-500 px-2 py-0.5 rounded-full">‚úì done</span>
            </button>
          </div>

          <!-- Description: Just generated -->
          <div id="description-image-core-id-4" class="text-sm text-slate-600 dark:text-slate-300 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-700 rounded-lg p-3">
            <p class="font-semibold text-emerald-700 dark:text-emerald-300 mb-1 flex items-center gap-2">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
              </svg>
              New description
            </p>
            A humorous image depicting a meeting scenario with multiple participants looking confused or disengaged.
          </div>
        </div>
      </div>

      <!-- Image 5: Done (stable state) -->
      <div class="glass-card rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105">
        <div class="p-4">
          <div class="relative mb-4">
            <img src="https://via.placeholder.com/300x200/334155/cbd5e1?text=keyboard.jpg" alt="Meme" class="w-full h-48 object-cover rounded-xl">
            <div class="absolute top-2 left-2 flex gap-1">
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-blue-500/80 text-white backdrop-blur-sm">programming</span>
            </div>
          </div>

          <h3 class="font-semibold text-slate-800 dark:text-white mb-2 truncate">keyboard.jpg</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-3">/memes/tech</p>

          <!-- Status: Done -->
          <div id="status-image-core-id-5" class="mb-3">
            <button class="w-full bg-blue-500 hover:bg-cyan-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold transition">
              generate description ü™Ñ
            </button>
          </div>

          <!-- Description: Stable -->
          <div id="description-image-core-id-5" class="text-sm text-slate-600 dark:text-slate-300">
            A mechanical keyboard with RGB lighting, commonly associated with programming culture and gaming setups.
          </div>
        </div>
      </div>

      <!-- Image 6: Failed -->
      <div class="glass-card rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105 ring-2 ring-red-400 dark:ring-red-600">
        <div class="p-4">
          <div class="relative mb-4">
            <img src="https://via.placeholder.com/300x200/334155/cbd5e1?text=corrupted.gif" alt="Meme" class="w-full h-48 object-cover rounded-xl opacity-60">
            <div class="absolute top-2 left-2 flex gap-1">
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-purple-500/80 text-white backdrop-blur-sm">funny</span>
            </div>
            <!-- Error indicator -->
            <div class="absolute top-2 right-2">
              <span class="flex h-6 w-6 bg-red-500 rounded-full items-center justify-center text-white text-xs font-bold">!</span>
            </div>
          </div>

          <h3 class="font-semibold text-slate-800 dark:text-white mb-2 truncate">corrupted.gif</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-3">/memes/broken</p>

          <!-- Status: Failed -->
          <div id="status-image-core-id-6" class="mb-3">
            <div class="flex gap-2">
              <span class="flex-1 bg-red-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold text-center">
                failed ‚ùå
              </span>
              <button class="bg-blue-500 hover:bg-cyan-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold transition" title="Retry">
                üîÑ
              </button>
            </div>
          </div>

          <!-- Error Message -->
          <div id="description-image-core-id-6" class="text-sm bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-3">
            <p class="text-red-700 dark:text-red-300 font-semibold mb-1">Generation failed</p>
            <p class="text-xs text-red-600 dark:text-red-400">
              Possible causes: invalid file format, model timeout, or service error. Try again or check logs.
            </p>
          </div>
        </div>
      </div>

      <!-- Image 7: Removing (cancellation in progress) -->
      <div class="glass-card rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105 opacity-50">
        <div class="p-4">
          <div class="relative mb-4">
            <img src="https://via.placeholder.com/300x200/334155/cbd5e1?text=pending.jpg" alt="Meme" class="w-full h-48 object-cover rounded-xl">
            <div class="absolute top-2 left-2 flex gap-1">
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-purple-500/80 text-white backdrop-blur-sm">funny</span>
            </div>
          </div>

          <h3 class="font-semibold text-slate-800 dark:text-white mb-2 truncate">pending.jpg</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-3">/memes/queue</p>

          <!-- Status: Removing -->
          <div id="status-image-core-id-7" class="mb-3">
            <span class="w-full block bg-red-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold text-center">
              removing üóëÔ∏è
            </span>
          </div>

          <div id="description-image-core-id-7" class="text-sm text-slate-600 dark:text-slate-400 italic">
            Cancelling...
          </div>
        </div>
      </div>

      <!-- Image 8: In Queue (waiting) -->
      <div class="glass-card rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105">
        <div class="p-4">
          <div class="relative mb-4">
            <img src="https://via.placeholder.com/300x200/334155/cbd5e1?text=waiting.png" alt="Meme" class="w-full h-48 object-cover rounded-xl">
            <div class="absolute top-2 left-2 flex gap-1">
              <span class="px-2 py-1 rounded-full text-xs font-semibold bg-blue-500/80 text-white backdrop-blur-sm">programming</span>
            </div>
            <!-- Queue position indicator -->
            <div class="absolute top-2 right-2">
              <span class="bg-amber-500/80 text-white text-xs font-bold px-2 py-1 rounded-full backdrop-blur-sm">
                #15
              </span>
            </div>
          </div>

          <h3 class="font-semibold text-slate-800 dark:text-white mb-2 truncate">waiting.png</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-3">/memes/pending</p>

          <!-- Status: In Queue -->
          <div id="status-image-core-id-8" class="mb-3 flex gap-2">
            <span class="flex-1 bg-amber-500 text-white py-2 px-3 rounded-2xl text-sm font-semibold text-center">
              in_queue ‚è≥
            </span>
            <button class="bg-red-500 hover:bg-red-400 text-white py-2 px-3 rounded-2xl text-sm font-semibold transition">
              cancel
            </button>
          </div>

          <div id="description-image-core-id-8" class="text-sm text-slate-600 dark:text-slate-400 italic">
            Waiting in queue...
          </div>
        </div>
      </div>

    </div>

    <!-- ActionCable Update Visualization -->
    <div class="bg-white/90 dark:bg-slate-800/90 backdrop-blur-lg rounded-2xl p-6 shadow-lg mt-8">
      <h3 class="text-lg font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2">
        <svg class="w-6 h-6 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
        </svg>
        Real-time ActionCable Updates
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Status Update Example -->
        <div class="bg-slate-50 dark:bg-slate-900 rounded-xl p-4">
          <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3">Status Broadcast Example</h4>
          <pre class="text-xs bg-slate-800 text-emerald-400 p-4 rounded-lg overflow-x-auto"><code>{
  "div_id": "status-image-core-id-3",
  "status_html": "&lt;span class='bg-emerald-500...'&gt;
    processing üîÑ
  &lt;/span&gt;"
}</code></pre>
          <p class="text-xs text-slate-600 dark:text-slate-400 mt-3">
            Broadcast channel: <code class="bg-slate-200 dark:bg-slate-700 px-2 py-1 rounded">image_status_channel</code>
          </p>
        </div>

        <!-- Description Update Example -->
        <div class="bg-slate-50 dark:bg-slate-900 rounded-xl p-4">
          <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3">Description Broadcast Example</h4>
          <pre class="text-xs bg-slate-800 text-emerald-400 p-4 rounded-lg overflow-x-auto"><code>{
  "div_id": "description-image-core-id-4",
  "description": "A humorous image depicting
    a meeting scenario..."
}</code></pre>
          <p class="text-xs text-slate-600 dark:text-slate-400 mt-3">
            Broadcast channel: <code class="bg-slate-200 dark:bg-slate-700 px-2 py-1 rounded">image_description_channel</code>
          </p>
        </div>
      </div>

      <div class="mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
        <p class="text-sm text-blue-700 dark:text-blue-300 flex items-start gap-2">
          <svg class="w-5 h-5 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
          </svg>
          <span>
            <strong>No code changes needed!</strong> Bulk generation reuses existing <code>ImageStatusChannel</code> and <code>ImageDescriptionChannel</code>.
            When Python service completes a job, it calls Rails webhooks (<code>status_receiver</code>, <code>description_receiver</code>),
            which broadcast to all connected clients. Individual cards update automatically.
          </span>
        </p>
      </div>
    </div>

    <!-- Design Notes -->
    <div class="bg-white/90 dark:bg-slate-800/90 backdrop-blur-lg rounded-2xl p-6 shadow-lg mt-8">
      <h3 class="text-lg font-bold text-slate-800 dark:text-white mb-4">Design Notes</h3>
      <ul class="space-y-2 text-sm text-slate-600 dark:text-slate-400">
        <li><strong>Status Badges:</strong> Same styling as existing <code>_generate_status.html.erb</code> partial (amber=in_queue, emerald=processing, red=failed, blue=done)</li>
        <li><strong>Real-time Updates:</strong> No polling needed for individual cards - ActionCable broadcasts instantly when Python service updates status/description</li>
        <li><strong>Visual Feedback:</strong> Processing cards have shimmer effect, completed cards have green ring for 3 seconds, failed cards have red ring</li>
        <li><strong>Queue Position:</strong> Optional enhancement - show position in queue for waiting images (#15 in top-right badge)</li>
        <li><strong>Cancel Button:</strong> Only appears for images in "in_queue" state, calls <code>generate_stopper</code> action</li>
        <li><strong>Retry Button:</strong> Appears for failed images, calls <code>generate_description</code> action again</li>
        <li><strong>Description Animation:</strong> New descriptions highlighted with emerald background for visibility</li>
        <li><strong>Error States:</strong> Failed images show helpful error message with possible causes</li>
        <li><strong>Removing State:</strong> Cards fade to 50% opacity when user cancels, then return to "not_started" state</li>
        <li><strong>Grid Layout:</strong> Responsive grid (1/2/3/4 columns), matches existing gallery layout</li>
      </ul>
    </div>

  </div>

</body>
</html>
