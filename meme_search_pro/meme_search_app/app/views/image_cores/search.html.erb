<div class="flex flex-col items-center justify-center mx-auto max-w-6xl px-4">
  <!-- Search Header -->
  <div class="text-center mb-8">
    <h1 class="text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent dark:from-indigo-400 dark:to-purple-400 mb-2">
      Search Memes
    </h1>
    <p class="text-gray-600 dark:text-gray-400">Find the perfect meme with keyword or vector search</p>
  </div>

  <!-- Search Form Card -->
  <div class="w-full max-w-4xl bg-white/90 dark:bg-slate-800/90 backdrop-blur-xl border border-white/20 dark:border-white/10 rounded-3xl p-8 shadow-2xl mb-8">
    <%= form_with url: search_items_image_cores_path, local: true, method: :post, data: {controller: "debounce", debounce_target: "form"} do |form| %>
      <div class="space-y-6">
        <!-- Search Input Row -->
        <div class="flex flex-col sm:flex-row gap-4 items-center">
          <%= form.hidden_field :checkbox_value, value: '0', id: 'checkbox_value' %>

          <!-- Search Box -->
          <div class="flex-1 w-full">
            <%= form.search_field :query,
              data: {action: "input->debounce#search"},
              placeholder: 'Search for memes...',
              class: "w-full px-6 py-4 text-gray-700 dark:text-gray-200 bg-white/80 dark:bg-slate-700/80 backdrop-blur-lg border-2 border-indigo-200/50 dark:border-indigo-700/50 rounded-2xl shadow-lg focus:outline-none focus:ring-4 focus:ring-indigo-500/50 dark:focus:ring-indigo-600/50 focus:border-indigo-500 dark:focus:border-indigo-600 transition-all text-lg",
              id: "search-box" %>
          </div>

          <!-- Search Mode Toggle -->
          <label class="inline-flex items-center cursor-pointer bg-gradient-to-br from-purple-50/50 to-indigo-50/50 dark:from-purple-900/20 dark:to-indigo-900/20 px-6 py-4 rounded-2xl border border-purple-200/50 dark:border-purple-700/50 shadow-lg">
            <input type="checkbox" value="" class="sr-only peer" id="search-toggle-checkbox" onchange="updateText()">
            <div id="search-toggle-div" class="relative w-14 h-7 bg-gray-300 dark:bg-gray-700 rounded-full peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 peer-checked:bg-purple-600 dark:peer-checked:bg-purple-500 transition-colors">
              <div class="absolute top-0.5 start-[4px] bg-white border border-gray-300 dark:border-gray-600 rounded-full h-6 w-6 transition-transform peer-checked:translate-x-full rtl:peer-checked:-translate-x-full"></div>
            </div>
            <span class="ms-3 text-sm font-semibold text-gray-900 dark:text-gray-200" id="search-toggle-text">Keyword</span>
          </label>
        </div>

        <!-- Tag Filter -->
        <div class="flex flex-col space-y-2">
          <label class="text-sm font-semibold text-gray-700 dark:text-gray-300">Filter by Tags</label>
          <%= form.hidden_field :source, value: 'form' %>
          <%= render 'tag_toggle' %>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Search Results Container -->
  <div id="search_results" class="w-full">
    <%= render "image_cores/no_search" %>
  </div>
</div>
<script>
  function updateText() {
      const checkbox = document.getElementById('search-toggle-checkbox');
      const text = document.getElementById('search-toggle-text');
      const hiddenField = document.getElementById('checkbox_value');
      hiddenField.value = checkbox.checked ? '1' : '0';
      text.textContent = checkbox.checked ? 'Vector' : 'Keyword';
  }
</script>